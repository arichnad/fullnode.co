extends layout
block content
  .col-md-12
    .container
      h2 Fund a full node & Contribute to the Bitcoin network
      p Full Bitcoin nodes are incredibly important for the safety of the network. <a href="http://coinchomp.com/2014/03/19/bitcoin-nodes-many-enough/">Here are a few reasons why</a>.
      p This is an <a href="https://github.com/orweinberger/fullnode.co" target="_blank">open-source</a>, non-profit project aimed to create as many full nodes as possible and to have them last as long as possible.
      p Once you complete the payment of $10 via the Coinbase button below, you will be prompted to select a unique DNS for your server (under *.fullnode.co).
      p After you complete the process a full node will be provisioned for you either on Linode or DigitalOcean (we plan to support more providers in the future).
      p Your full node will be online for a month and in the near future you will be able to top-up the nodes.
      p If you have any questions, <a href="/faq">have a look here</a>.
      p Charts and graphs are powered by <a href="https://joola.io">joola.io</a>
      p <a href="/servers">Complete server list</a>
      p: strong Due to some issues with Coinbase some contributors were not able to name their nodes, if you are one of those contributors please email me at orweinberger@gmail.com with the transaction ID and I will assist you with naming the node.

  .col-md-12

    .container
      hr
      .coinbase
        a.coinbaselink(href="#")
          img(src="https://coinbase.com/assets/buttons/buy_now_large-cac4e1e8d97c83a62dc249573c5afb3f.png")
        div.coinbase-button(data-code="0b41e454a8d32f1096e8dd90d45d03ff", data-button-style="none", data-custom="#{uuid}")
    br
    .container
      .col-md-8
        #serverCount-timeline
      .col-md-4
        #dc-pie

  script(src="http://109.74.194.86:8080/joola.io.js")
  script.
    var uuid = '#{uuid}';
    var options = { "APIToken":"apitoken-reader" }
    joolaio.init(options,function(err,res) {
    var serverCount_timeline_query = {
      "timeframe": "last_day",
      "interval": "hour",
      "collection": "prod_bitcoin",
      //"dimensions": ["timestamp"],
      "dimensions": [
        {key: 'timestamp', collection: 'prod_bitcoin'}
      ],
      "metrics": ["servers"],
      "realtime": false
    }
    
    var dc_pie_query = {
      "timeframe": "last_month",
      "interval": "day",
      "collection": "prod_bitcoin",
      "dimensions": [
        {key: 'dc', collection: 'prod_bitcoin'}
      ],
      "metrics": ["servers"],
      "realtime": false
    }
    
    var last_month_server_query = {
    "timeframe":"last_month",
    "interval":"day",
    "collection":"prod_bitcoin",
    "dimensions":["ipaddress"],
    "metrics":["servers"],
    "realtime":false
    
    }
    
    var last_all_server_query = {
    "timeframe":"last_year",
    "interval":"day",
    "collection":"prod_bitcoin",
    "dimensions":["ipaddress"],
    "metrics":["servers"],
    "realtime":false
    }
    
    $('#serverCount-timeline').Timeline({force: true,
    chart: {
      chart: {
      type: 'line'
      },
      
      plotOptions: {
        line: {
          color: 'rgba(87,173,104,0.8)',
          pointWidth: 15
        }
      }
    },query:serverCount_timeline_query});
    $('#dc-pie').Pie({query:dc_pie_query});
    //$('#serverCountMonth-metric').Metric({query:last_month_server_query});
    //$('#serverCountAll-metric').Metric({query:last_all_server_query});
    });
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-51194133-1', 'fullnode.co');
    ga('send', 'pageview');

  script(src="http://localhost:3000/socket.io/socket.io.js", type="text/javascript")
  script.
      var socket = io.connect('http://localhost:3000');
      /*
      socket.on('welcome', function(data) {
        $('#messages').append('<li>' + data.message + '</li>');
          socket.emit('i am client', {data: 'foo!'});
      });
      */
      socket.on('#{uuid}', function(data) {
        window.location = '/dns/#{uuid}';
      });